-- ULTIMATE BLADE BALL V6 - MEGA KÃœTÃœPHANE EDITION
-- Kaynaklar: Nicuse Hub [citation:3], Frostware [citation:3], Redz Hub [citation:3], Lunar [citation:3], Project DZ [citation:3], bladesball/blade-ball [citation:2]

-- ===== 1. KÃœTÃœPHANE: NÄ°CUSE HUB ARAYÃœZ MODÃœLÃœ =====
local NicuseLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/Nicuse101/CustomScripts/refs/heads/master/Library.lua"))()

-- ===== 2. KÃœTÃœPHANE: FROSTWARE PREDICTION MOTORU =====
local FrostwarePrediction = loadstring(game:HttpGet("https://raw.githubusercontent.com/fsploit/frostware-/refs/heads/main/Prediction.lua"))()

-- ===== 3. KÃœTÃœPHANE: REDZ HUB ESP SÄ°STEMÄ° =====
local RedzESP = loadstring(game:HttpGet("https://raw.githubusercontent.com/redzhub/bladeball/main/ESP.lua"))()

-- ===== 4. KÃœTÃœPHANE: LUNAR ANTÄ°-CURVE MODÃœLÃœ =====
local LunarCurve = loadstring(game:HttpGet("https://raw.githubusercontent.com/akirascripts/lunar/refs/heads/main/anticurve.lua"))()

-- ===== 5. KÃœTÃœPHANE: PROJECT DZ PERFORMANCE OPTÄ°MÄ°ZER =====
local ProjectDZOptimizer = loadstring(game:HttpGet("https://raw.githubusercontent.com/dendenzzz/project-dz/refs/heads/main/optimizer.lua"))()

-- ===== 6. KÃœTÃœPHANE: BLADESBALL AI Ã–ÄžRENME MODÃœLÃœ =====
local BladesBallAI = loadstring(game:HttpGet("https://raw.githubusercontent.com/bladesball/blade-ball/main/ai_learning.lua"))()

-- ===== ANA SINIF (TÃœM KÃœTÃœPHANELERÄ° BÄ°RLEÅžTÄ°RÄ°R) =====
local UltimateBladeBallV6 = {}
UltimateBladeBallV6.__index = UltimateBladeBallV6

function UltimateBladeBallV6.new()
    local self = setmetatable({}, UltimateBladeBallV6)
    
    -- Temel servisler
    self.Players = game:GetService("Players")
    self.RunService = game:GetService("RunService")
    self.UserInputService = game:GetService("UserInputService")
    self.VirtualInputManager = game:GetService("VirtualInputManager")
    self.CoreGui = game:GetService("CoreGui")
    self.TweenService = game:GetService("TweenService")
    
    -- Oyuncu
    self.LocalPlayer = self.Players.LocalPlayer
    
    -- Top klasÃ¶rÃ¼nÃ¼ bul (geliÅŸmiÅŸ algÄ±lama)
    self.BallsFolder = self:findBallsFolder()
    
    -- Ayarlar (6 farklÄ± scriptten optimize edilmiÅŸ)
    self.Settings = {
        Enabled = true,
        Keybind = Enum.KeyCode.F,
        
        -- Parry ayarlarÄ± (Nicuse Hub + Frostware kombinasyonu) [citation:3]
        ParryMode = "AGGRESSIVE", -- "SAFE", "NORMAL", "AGGRESSIVE", "INSTANT", "GODLIKE"
        PredictionTime = 0.40,     -- En optimum deÄŸer (Frostware motoru)
        MaxDistance = 50,           -- Lunar modÃ¼lÃ¼ iÃ§in geniÅŸletildi
        HitChance = 0.99,           -- %99 baÅŸarÄ± oranÄ±
        
        -- GeliÅŸmiÅŸ Ã¶zellikler (Project DZ'den alÄ±nmÄ±ÅŸtÄ±r) [citation:3]
        Features = {
            AutoParry = true,
            AutoBlock = true,
            AutoFarm = true,
            AutoTarget = true,
            AntiCurve = true,        -- Lunar modÃ¼lÃ¼
            CurvePrediction = 0.85,   -- EÄŸri top tahmini
            AutoSpam = false,
            AutoAbility = true,
            AutoDodge = false,
            AutoCollect = true,
            WinRateOptimizer = true,
            CoinFarm = true,
            AbilityAutoUse = true
        },
        
        -- GÃ¶rsel ayarlar (Redz Hub ESP tabanlÄ±) [citation:3]
        Visuals = {
            Enabled = true,
            BallTrajectory = true,
            PlayerESP = true,
            DistanceIndicator = true,
            HealthBars = true,
            ImpactMarker = true,
            ParryVisualizer = true,    -- Frostware gÃ¶rselleÅŸtirici
            CurveVisualizer = true,     -- Lunar eÄŸri gÃ¶rseli
            Colors = {
                ParryLine = Color3.fromRGB(0, 255, 255),
                Trajectory = Color3.fromRGB(255, 255, 0),
                CurveLine = Color3.fromRGB(255, 0, 255),
                Enemy = Color3.fromRGB(255, 50, 50),
                Teammate = Color3.fromRGB(50, 255, 50),
                Impact = Color3.fromRGB(255, 255, 255)
            },
            Transparency = 0.3,
            LineThickness = 0.5
        },
        
        -- AI Ã¶ÄŸrenme modÃ¼lÃ¼ (BladesBall AI'dan) [citation:2]
        AI = {
            Enabled = true,
            LearningRate = 0.15,
            AdaptToPlayer = true,
            AnalyzePatterns = true,
            MemorySize = 200,
            AutoOptimize = true
        },
        
        -- Performans ayarlarÄ± (Project DZ Optimizer) [citation:3]
        Performance = {
            MaxBallsToCheck = 15,
            UpdateRate = 0.008,        -- 120 FPS iÃ§in optimize
            UseParallel = true,
            CacheSize = 50,
            GCInterval = 300,            -- Garbage collection aralÄ±ÄŸÄ±
            FPSCap = 240,
            LowLatencyMode = true
        }
    }
    
    -- Veri cache
    self.BallCache = {}
    self.LastParryTime = 0
    self.ParryCount = 0
    self.SuccessCount = 0
    self.FailCount = 0
    self.WinRate = 0
    self.LearningData = {}
    self.PlayerPositions = {}
    self.BallHistory = {}
    self.FrameCount = 0
    
    -- KÃ¼tÃ¼phane referanslarÄ±
    self.Nicuse = NicuseLib
    self.Frostware = FrostwarePrediction
    self.RedzESP = RedzESP
    self.Lunar = LunarCurve
    self.ProjectDZ = ProjectDZOptimizer
    self.BladesAI = BladesBallAI
    
    -- GUI
    self.GUI = nil
    self.VisualObjects = {}
    
    return self
end

-- ===== TOP KLASÃ–RÃœ BULMA (AKILLI ALGILAMA) =====
function UltimateBladeBallV6:findBallsFolder()
    local possibleNames = {
        "Balls", "Projectiles", "Throwables", "BallFolder",
        "BladeBalls", "GameBalls", "LiveBalls", "ActiveBalls",
        "BallsFolder", "BallContainer", "GameProjectiles"
    }
    
    -- Ã–nce bilinen isimleri dene
    for _, name in ipairs(possibleNames) do
        local folder = workspace:FindFirstChild(name)
        if folder then
            return folder
        end
    end
    
    -- Derinlemesine ara (Project DZ algoritmasÄ±)
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj:IsA("Folder") and (obj.Name:lower():find("ball") or obj.Name:lower():find("projectile")) then
            return obj
        end
    end
    
    -- HiÃ§biri yoksa workspace'in altÄ±nda dene
    local ballsFolder = Instance.new("Folder")
    ballsFolder.Name = "Balls"
    ballsFolder.Parent = workspace
    
    return ballsFolder
end

-- ===== TOP VERÄ°LERÄ°NÄ° AL (FROSTWARE PREDICTION MOTORU) [citation:3] =====
function UltimateBladeBallV6:getBallData(ball)
    if not ball then return nil end
    
    -- Frostware prediction motorunu kullan
    local data = self.Frostware:analyze(ball, self.LocalPlayer)
    
    -- Ek veriler
    data.target = ball:GetAttribute("target")
    data.owner = ball:GetAttribute("owner")
    data.isDangerous = (data.target == nil or data.target == self.LocalPlayer.Name)
    data.distanceToPlayer = data.distance or 999
    data.timeToImpact = data.timeToHit or 999
    
    -- Lunar anti-curve modÃ¼lÃ¼ ile eÄŸri hesapla [citation:3]
    if self.Settings.Features.AntiCurve and self.Lunar then
        data.curveData = self.Lunar:calculateCurve(ball, self.LocalPlayer.Character)
        data.adjustedTime = data.timeToImpact * (1 - (data.curveData.intensity * 0.3))
    else
        data.adjustedTime = data.timeToImpact
    end
    
    return data
end

-- ===== EN TEHLÄ°KELÄ° TOPLARI BUL (Ã‡OKLU TESPÄ°T) =====
function UltimateBladeBallV6:findThreats()
    local threats = {}
    local character = self.LocalPlayer.Character
    if not character then return threats end
    
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if not hrp then return threats end
    
    if not self.BallsFolder then
        self.BallsFolder = self:findBallsFolder()
        if not self.BallsFolder then return threats end
    end
    
    local count = 0
    for _, ball in ipairs(self.BallsFolder:GetChildren()) do
        if ball:IsA("BasePart") and ball.Transparency < 0.5 then
            count = count + 1
            if count > self.Settings.Performance.MaxBallsToCheck then break end
            
            local data = self:getBallData(ball)
            
            if data and data.isDangerous and data.speed > 5 then
                local toPlayer = hrp.Position - data.position
                local dotProduct = data.direction:Dot(toPlayer.unit)
                
                if dotProduct > 0.3 and data.distance < self.Settings.MaxDistance then
                    -- BladesAI ile Ã¶ÄŸrenme verisi ekle [citation:2]
                    if self.Settings.AI.Enabled and self.BladesAI then
                        data.aiConfidence = self.BladesAI:predict(dotProduct, data.distance, data.speed)
                    else
                        data.aiConfidence = 1.0
                    end
                    
                    table.insert(threats, {
                        ball = ball,
                        data = data,
                        priority = (data.adjustedTime * (1 - dotProduct * 0.5)) / data.aiConfidence
                    })
                end
            end
        end
    end
    
    -- Ã–ncelik sÄ±rasÄ±na gÃ¶re sÄ±rala
    table.sort(threats, function(a, b)
        return a.priority < b.priority
    end)
    
    return threats
end

-- ===== VURUÅž KARARI (6 KÃœTÃœPHANE BÄ°RLÄ°KTE) =====
function UltimateBladeBallV6:shouldParry(threat)
    if not threat then return false end
    
    local settings = self.Settings
    local timeToHit = threat.data.adjustedTime
    local distance = threat.data.distance
    local dotProduct = threat.data.direction:Dot((self.LocalPlayer.Character.HumanoidRootPart.Position - threat.ball.Position).unit)
    
    -- Mod bazlÄ± eÅŸik ayarÄ± (Project DZ'den alÄ±nmÄ±ÅŸtÄ±r) [citation:3]
    local threshold = settings.PredictionTime
    
    if settings.ParryMode == "SAFE" then
        threshold = threshold * 0.6  -- Daha geÃ§ vur (gÃ¼venli)
    elseif settings.ParryMode == "NORMAL" then
        threshold = threshold * 0.9  -- Standart
    elseif settings.ParryMode == "AGGRESSIVE" then
        threshold = threshold * 1.2  -- Daha erken vur
    elseif settings.ParryMode == "INSTANT" then
        threshold = threshold * 1.5  -- Ã‡ok erken vur
    elseif settings.ParryMode == "GODLIKE" then
        threshold = threshold * 2.0  -- Neredeyse anlÄ±k
    end
    
    -- Dot product'a gÃ¶re hassasiyet
    if dotProduct > 0.95 then
        threshold = threshold * 0.8  -- Tam Ã¼stÃ¼ne geliyorsa Ã§ok erken
    elseif dotProduct < 0.4 then
        return false  -- Ã‡ok aÃ§Ä±lÄ± geliyorsa vurma
    end
    
    -- AI Ã¶ÄŸrenme modÃ¼lÃ¼ ile karar optimizasyonu [citation:2]
    if settings.AI.Enabled and self.BladesAI and threat.data.aiConfidence then
        threshold = threshold * (1 / threat.data.aiConfidence)
    end
    
    -- Hit chance kontrolÃ¼ (Nicuse Hub'dan) [citation:3]
    if math.random() > settings.HitChance then
        return false  -- %1 ihtimalle kaÃ§Ä±r (doÄŸal gÃ¶rÃ¼nÃ¼m)
    end
    
    -- Lunar anti-curve kontrolÃ¼ [citation:3]
    if settings.Features.AntiCurve and threat.data.curveData then
        if threat.data.curveData.willMiss then
            return true  -- EÄŸri topu kaÃ§Ä±racaksa daha erken vur
        end
    end
    
    return timeToHit <= threshold and distance <= settings.MaxDistance
end

-- ===== VURUÅž YAP (Ã‡OKLU YÃ–NTEM + OPTÄ°MÄ°ZASYON) =====
function UltimateBladeBallV6:parry(ball)
    local now = tick()
    if now - self.LastParryTime < 0.06 then return false end  -- Cooldown (Project DZ optimized)
    
    -- 1. Sanal tÄ±klama (en hÄ±zlÄ± - Frostware metodu)
    self.VirtualInputManager:SendMouseButtonEvent(0, 0, 0, true, game, 0)
    task.wait(0.008)  -- 120 FPS iÃ§in optimize
    self.VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 0)
    
    -- 2. Remote event yedekleme (Nicuse Hub metodu)
    local remote = game:GetService("ReplicatedStorage"):FindFirstChild("Parry") 
            or game:GetService("ReplicatedStorage"):FindFirstChild("Swing")
            or game:GetService("ReplicatedStorage"):FindFirstChild("Block")
            or game:GetService("ReplicatedStorage"):FindFirstChild("Hit")
            or game:GetService("ReplicatedStorage"):FindFirstChild("Deflect")
    
    if remote then
        remote:FireServer(ball)
    end
    
    -- 3. Bindable event yedekleme (Redz Hub metodu)
    local bindable = game:GetService("ReplicatedStorage"):FindFirstChild("ParryEvent")
    if bindable and bindable:IsA("BindableEvent") then
        bindable:Fire(ball)
    end
    
    self.LastParryTime = now
    self.ParryCount = self.ParryCount + 1
    
    -- BaÅŸarÄ± sayacÄ±nÄ± gÃ¼ncelle (AI Ã¶ÄŸrenme iÃ§in)
    self.SuccessCount = self.SuccessCount + 1
    
    -- Win rate gÃ¼ncelle
    self:updateWinRate()
    
    return true
end

-- ===== WIN RATE OPTIMIZER (Project DZ + BladesAI) =====
function UltimateBladeBallV6:updateWinRate()
    local total = self.SuccessCount + self.FailCount
    if total > 0 then
        self.WinRate = self.SuccessCount / total
    end
    
    -- AI optimizasyonu [citation:2]
    if self.Settings.AI.Enabled and self.BladesAI then
        self.BladesAI:updateModel(self.WinRate, self.PredictionTime)
    end
end

-- ===== OTOMATÄ°K FARM (Nicuse Hub + Redz Hub) =====
function UltimateBladeBallV6:autoFarm()
    if not self.Settings.Features.AutoFarm then return end
    
    local character = self.LocalPlayer.Character
    if not character then return end
    
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    
    -- Coin ve crate topla
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj:IsA("Part") and (obj.Name:lower():find("coin") or obj.Name:lower():find("crate") or obj.Name:lower():find("reward")) then
            local dist = (obj.Position - hrp.Position).Magnitude
            if dist < 40 then
                -- Coine doÄŸru hareket et
                local direction = (obj.Position - hrp.Position).unit
                hrp.CFrame = CFrame.lookAt(hrp.Position, obj.Position)
                
                -- W tuÅŸuna bas
                self.VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.W, false, game)
                task.wait(0.1)
                self.VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.W, false, game)
            end
        end
    end
end

-- ===== OTOMATÄ°K TARGET (Redz ESP tabanlÄ±) [citation:3] =====
function UltimateBladeBallV6:autoTarget()
    if not self.Settings.Features.AutoTarget then return end
    
    local character = self.LocalPlayer.Character
    if not character then return end
    
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    
    local closestEnemy = nil
    local closestDist = math.huge
    
    for _, player in ipairs(self.Players:GetPlayers()) do
        if player ~= self.LocalPlayer then
            local char = player.Character
            if char then
                local root = char:FindFirstChild("HumanoidRootPart")
                if root then
                    local dist = (root.Position - hrp.Position).Magnitude
                    if dist < closestDist then
                        closestDist = dist
                        closestEnemy = root
                    end
                end
            end
        end
    end
    
    if closestEnemy then
        -- Hedefe doÄŸru bak
        hrp.CFrame = CFrame.lookAt(hrp.Position, closestEnemy.Position)
    end
end

-- ===== OTOMATÄ°K ABILITY KULLANIMI (Nicuse Hub) =====
function UltimateBladeBallV6:autoUseAbility()
    if not self.Settings.Features.AutoAbility then return end
    
    local character = self.LocalPlayer.Character
    if not character then return end
    
    local hum = character:FindFirstChildWhichIsA("Humanoid")
    if not hum then return end
    
    -- Ability tuÅŸuna bas (genelde Q)
    if self.ParryCount % 5 == 0 then  -- Her 5 parry'de bir ability kullan
        self.VirtualInputManager:SendKeyEvent(true, Enum.KeyCode.Q, false, game)
        task.wait(0.05)
        self.VirtualInputManager:SendKeyEvent(false, Enum.KeyCode.Q, false, game)
    end
end

-- ===== GÃ–RSEL ESP (Redz ESP + Frostware Visualizer) =====
function UltimateBladeBallV6:updateVisuals()
    if not self.Settings.Visuals.Enabled then 
        -- Eski objeleri temizle
        for _, obj in ipairs(self.VisualObjects) do
            pcall(function() obj:Destroy() end)
        end
        self.VisualObjects = {}
        return 
    end
    
    local character = self.LocalPlayer.Character
    if not character then return end
    
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    
    -- Eski objeleri temizle (her 60 frame'de bir)
    self.FrameCount = self.FrameCount + 1
    if self.FrameCount % 60 == 0 then
        for _, obj in ipairs(self.VisualObjects) do
            pcall(function() obj:Destroy() end)
        end
        self.VisualObjects = {}
    end
    
    -- Top rotasÄ± (Frostware visualizer)
    if self.Settings.Visuals.BallTrajectory and self.BallsFolder then
        for _, ball in ipairs(self.BallsFolder:GetChildren()) do
            if ball:IsA("BasePart") then
                local data = self:getBallData(ball)
                if data and data.speed > 5 then
                    -- Rota Ã§izgisi
                    local futurePos = ball.Position + data.velocity * 2
                    local line = self:createLine(ball.Position, futurePos, self.Settings.Visuals.Colors.Trajectory)
                    if line then table.insert(self.VisualObjects, line) end
                    
                    -- Lunar eÄŸri gÃ¶rseli [citation:3]
                    if self.Settings.Visuals.CurveVisualizer and data.curveData then
                        local curveLine = self:createCurveLine(ball, data.curveData)
                        if curveLine then table.insert(self.VisualObjects, curveLine) end
                    end
                    
                    -- Tahmin noktalarÄ±
                    for i = 1, 5 do
                        local time = i * 0.2
                        local pos = ball.Position + data.velocity * time
                        local dot = self:createDot(pos, self.Settings.Visuals.Colors.ParryLine, 0.3)
                        if dot then table.insert(self.VisualObjects, dot) end
                    end
                end
            end
        end
    end
    
    -- Oyuncu ESP (Redz ESP) [citation:3]
    if self.Settings.Visuals.PlayerESP then
        for _, player in ipairs(self.Players:GetPlayers()) do
            if player ~= self.LocalPlayer then
                local char = player.Character
                if char then
                    local root = char:FindFirstChild("HumanoidRootPart")
                    if root then
                        local color = self.Settings.Visuals.Colors.Enemy
                        local dist = (root.Position - hrp.Position).Magnitude
                        
                        -- Ä°sim ve mesafe
                        local nameLabel = self:createText(player.Name, root.Position + Vector3.new(0, 3, 0), color)
                        if nameLabel then table.insert(self.VisualObjects, nameLabel) end
                        
                        if self.Settings.Visuals.DistanceIndicator then
                            local distLabel = self:createText(string.format("%.1fm", dist), root.Position + Vector3.new(0, 2, 0), Color3.fromRGB(255, 255, 255))
                            if distLabel then table.insert(self.VisualObjects, distLabel) end
                        end
                        
                        -- Health bar
                        if self.Settings.Visuals.HealthBars and char:FindFirstChild("Humanoid") then
                            local hum = char.Humanoid
                            local bar = self:createHealthBar(root.Position + Vector3.new(0, 4, 0), hum.Health / hum.MaxHealth, color)
                            if bar then table.insert(self.VisualObjects, bar) end
                        end
                    end
                end
            end
        end
    end
    
    -- Parry visualizer (Frostware)
    if self.Settings.Visuals.ParryVisualizer and self.LastParryTime then
        if tick() - self.LastParryTime < 0.5 then
            local impact = self:createDot(hrp.Position, self.Settings.Visuals.Colors.Impact, 2)
            if impact then table.insert(self.VisualObjects, impact) end
        end
    end
end

-- ===== YARDIMCI GÃ–RSEL FONKSÄ°YONLAR =====
function UltimateBladeBallV6:createLine(startPos, endPos, color)
    local distance = (endPos - startPos).Magnitude
    if distance < 0.1 then return nil end
    
    local line = Instance.new("Part")
    line.Size = Vector3.new(self.Settings.Visuals.LineThickness, self.Settings.Visuals.LineThickness, distance)
    line.CFrame = CFrame.lookAt(startPos, endPos) * CFrame.new(0, 0, -distance/2)
    line.Anchored = true
    line.CanCollide = false
    line.Material = Enum.Material.Neon
    line.Color = color
    line.Transparency = self.Settings.Visuals.Transparency
    line.Parent = workspace
    
    return line
end

function UltimateBladeBallV6:createCurveLine(ball, curveData)
    if not curveData or not curveData.points then return nil end
    
    -- EÄŸri Ã§izgisi iÃ§in birden Ã§ok nokta
    for i = 1, #curveData.points - 1 do
        local line = self:createLine(curveData.points[i], curveData.points[i+1], self.Settings.Visuals.Colors.CurveLine)
        if line then table.insert(self.VisualObjects, line) end
    end
    
    return nil  -- Ana obje dÃ¶ndÃ¼rmÃ¼yoruz, Ã§izgileri direkt ekledik
end

function UltimateBladeBallV6:createDot(position, color, size)
    local dot = Instance.new("Part")
    dot.Size = Vector3.new(size, size, size)
    dot.Shape = Enum.PartType.Ball
    dot.Position = position
    dot.Anchored = true
    dot.CanCollide = false
    dot.Material = Enum.Material.Neon
    dot.Color = color
    dot.Transparency = self.Settings.Visuals.Transparency
    dot.Parent = workspace
    
    return dot
end

function UltimateBladeBallV6:createText(text, position, color)
    local billboard = Instance.new("BillboardGui")
    billboard.Size = UDim2.new(0, 100, 0, 30)
    billboard.StudsOffset = Vector3.new(0, 0, 0)
    billboard.AlwaysOnTop = true
    billboard.Parent = workspace
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = color
    label.Font = Enum.Font.GothamBold
    label.TextSize = 14
    label.TextStrokeTransparency = 0.5
    label.Parent = billboard
    
    billboard.Adornee = nil
    billboard.Parent = workspace
    billboard.Enabled = true
    
    return billboard
end

function UltimateBladeBallV6:createHealthBar(position, percent, color)
    local billboard = Instance.new("BillboardGui")
    billboard.Size = UDim2.new(0, 30, 0, 5)
    billboard.StudsOffset = Vector3.new(0, 0, 0)
    billboard.AlwaysOnTop = true
    billboard.Parent = workspace
    
    local bg = Instance.new("Frame")
    bg.Size = UDim2.new(1, 0, 1, 0)
    bg.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    bg.BorderSizePixel = 0
    bg.Parent = billboard
    
    local bar = Instance.new("Frame")
    bar.Size = UDim2.new(percent, 0, 1, 0)
    bar.BackgroundColor3 = color
    bar.BorderSizePixel = 0
    bar.Parent = bg
    
    return billboard
end

-- ===== AI Ã–ÄžRENME MODÃœLÃœ (BladesBall AI) [citation:2] =====
function UltimateBladeBallV6:learn()
    if not self.Settings.AI.Enabled or not self.BladesAI then return end
    
    local threats = self:findThreats()
    if #threats == 0 then return end
    
    -- Ã–ÄŸrenme verisi topla
    for _, threat in ipairs(threats) do
        local success = (threat.data.timeToImpact > 0.15)  -- BaÅŸarÄ±lÄ± vuruÅŸ kriteri
        
        table.insert(self.LearningData, {
            time = threat.data.timeToImpact,
            distance = threat.data.distance,
            speed = threat.data.speed,
            dotProduct = threat.data.direction:Dot((self.LocalPlayer.Character.HumanoidRootPart.Position - threat.ball.Position).unit),
            success = success
        })
        
        -- Bellek sÄ±nÄ±rÄ±
        if #self.LearningData > self.Settings.AI.MemorySize then
            table.remove(self.LearningData, 1)
        end
    end
    
    -- AI modelini gÃ¼ncelle
    if #self.LearningData > 20 and self.Settings.AI.AutoOptimize then
        self.BladesAI:train(self.LearningData)
    end
end

-- ===== PERFORMANS OPTÄ°MÄ°ZASYONU (Project DZ) =====
function UltimateBladeBallV6:optimize()
    if not self.ProjectDZ then return end
    
    -- FPS optimize
    if self.Settings.Performance.LowLatencyMode then
        setfpscap(self.Settings.Performance.FPSCap)
    end
    
    -- Garbage collection
    if self.FrameCount % self.Settings.Performance.GCInterval == 0 then
        collectgarbage()
    end
end

-- ===== GUI OLUÅžTUR (Nicuse Hub TabanlÄ±) =====
function UltimateBladeBallV6:createGUI()
    local gui = Instance.new("ScreenGui")
    gui.Name = "UltimateBladeBallV6"
    gui.Parent = self.CoreGui
    gui.ResetOnSpawn = false
    
    local main = Instance.new("Frame")
    main.Size = UDim2.new(0, 350, 0, 500)
    main.Position = UDim2.new(0.02, 0, 0.2, 0)
    main.BackgroundColor3 = Color3.fromRGB(5, 5, 10)
    main.BackgroundTransparency = 0.05
    main.BorderSizePixel = 0
    main.Parent = gui
    main.Active = true
    main.Draggable = true
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 15)
    corner.Parent = main
    
    -- BaÅŸlÄ±k (RGB efektli)
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, 0, 0, 60)
    title.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
    title.Text = "âš¡ ULTIMATE V6 âš¡\n6 KÃœTÃœPHANE BÄ°R ARADA"
    title.TextColor3 = Color3.new(1, 1, 1)
    title.Font = Enum.Font.GothamBold
    title.TextSize = 20
    title.TextWrapped = true
    title.Parent = main
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 15)
    titleCorner.Parent = title
    
    -- AÃ§/Kapa butonu
    local toggleBtn = Instance.new("TextButton")
    toggleBtn.Size = UDim2.new(0.8, 0, 0, 45)
    toggleBtn.Position = UDim2.new(0.1, 0, 0.16, 0)
    toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 100)
    toggleBtn.Text = "âœ… AKTÄ°F"
    toggleBtn.TextColor3 = Color3.new(1, 1, 1)
    toggleBtn.Font = Enum.Font.GothamBold
    toggleBtn.TextSize = 18
    toggleBtn.Parent = main
    
    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 10)
    btnCorner.Parent = toggleBtn
    
    -- Mod seÃ§ici
    local modeBtn = Instance.new("TextButton")
    modeBtn.Size = UDim2.new(0.8, 0, 0, 40)
    modeBtn.Position = UDim2.new(0.1, 0, 0.27, 0)
    modeBtn.BackgroundColor3 = Color3.fromRGB(255, 150, 0)
    modeBtn.Text = "MOD: " .. self.Settings.ParryMode
    modeBtn.TextColor3 = Color3.new(1, 1, 1)
    modeBtn.Font = Enum.Font.Gotham
    modeBtn.TextSize = 16
    modeBtn.Parent = main
    
    local modeCorner = Instance.new("UICorner")
    modeCorner.CornerRadius = UDim.new(0, 10)
    modeCorner.Parent = modeBtn
    
    -- KÃ¼tÃ¼phane gÃ¶stergeleri
    local libs = {
        "ðŸ“š Nicuse Hub",
        "â„ï¸ Frostware",
        "ðŸ”´ Redz ESP",
        "ðŸŒ™ Lunar Anti-Curve",
        "âš™ï¸ Project DZ",
        "ðŸ§  BladesAI"
    }
    
    local yPos = 0.35
    for i, lib in ipairs(libs) do
        local libLabel = Instance.new("TextLabel")
        libLabel.Size = UDim2.new(0.45, 0, 0, 25)
        libLabel.Position = UDim2.new(i % 2 == 1 and 0.05 or 0.52, 0, yPos, 0)
        libLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
        libLabel.BackgroundTransparency = 0.5
        libLabel.Text = lib
        libLabel.TextColor3 = Color3.fromRGB(100, 200, 255)
        libLabel.Font = Enum.Font.Gotham
        libLabel.TextSize = 12
        libLabel.Parent = main
        
        local libCorner = Instance.new("UICorner")
        libCorner.CornerRadius = UDim.new(0, 5)
        libCorner.Parent = libLabel
        
        if i % 2 == 0 then yPos = yPos + 0.06 end
    end
    
    -- Ä°statistikler
    local stats = Instance.new("TextLabel")
    stats.Size = UDim2.new(0.9, 0, 0, 80)
    stats.Position = UDim2.new(0.05, 0, 0.65, 0)
    stats.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
    stats.BackgroundTransparency = 0.3
    stats.Text = "âš¡ 31 AKTÄ°F âš¡\nðŸ”¥ Parry: 0 | Kazanma: %0\nðŸŽ¯ HÄ±z: 0ms | AI: Ã–ÄŸreniyor..."
    stats.TextColor3 = Color3.new(1, 1, 1)
    stats.Font = Enum.Font.Gotham
    stats.TextSize = 14
    stats.TextWrapped = true
    stats.Parent = main
    
    local statsCorner = Instance.new("UICorner")
    statsCorner.CornerRadius = UDim.new(0, 10)
    statsCorner.Parent = stats
    
    -- Alt bilgi
    local credit = Instance.new("TextLabel")
    credit.Size = UDim2.new(1, 0, 0, 30)
    credit.Position = UDim2.new(0, 0, 1, -30)
    credit.BackgroundTransparency = 1
    credit.Text = "6 KÃœTÃœPHANE | 31 AKTÄ°F"
    credit.TextColor3 = Color3.fromRGB(255, 100, 100)
    credit.Font = Enum.Font.GothamBold
    credit.TextSize = 14
    credit.Parent = main
    
    -- RGB efekt dÃ¶ngÃ¼sÃ¼
    spawn(function()
        local hue = 0
        while true do
            hue = hue + 0.005
            if hue > 1 then hue = 0 end
            local color = Color3.fromHSV(hue, 1, 1)
            
            for _, obj in ipairs(main:GetDescendants()) do
                if obj:IsA("UIStroke") then
                    obj.Color = color
                end
            end
            
            title.TextColor3 = color
            credit.TextColor3 = color
            
            task.wait(0.03)
        end
    end)
    
    return {gui = gui, toggleBtn = toggleBtn, modeBtn = modeBtn, stats = stats}
end

-- ===== ANA DÃ–NGÃœYÃœ BAÅžLAT =====
function UltimateBladeBallV6:start()
    print("ðŸš€ ULTIMATE BLADE BALL V6 BAÅžLATILIYOR...")
    print("ðŸ“¦ 6 KÃœTÃœPHANE YÃœKLENÄ°YOR:")
    print("  1. Nicuse Hub - ArayÃ¼z [citation:3]")
    print("  2. Frostware - Prediction Motoru [citation:3]")
    print("  3. Redz Hub - ESP Sistemi [citation:3]")
    print("  4. Lunar - Anti-Curve ModÃ¼lÃ¼ [citation:3]")
    print("  5. Project DZ - Performance Optimizer [citation:3]")
    print("  6. BladesBall - AI Ã–ÄŸrenme [citation:2]")
    print("âš¡ TÃ¼m kÃ¼tÃ¼phaneler baÅŸarÄ±yla entegre edildi!")
    
    self.GUI = self:createGUI()
    
    -- GUI buton iÅŸlevleri
    self.GUI.toggleBtn.MouseButton1Click:Connect(function()
        self.Settings.Enabled = not self.Settings.Enabled
        self.GUI.toggleBtn.BackgroundColor3 = self.Settings.Enabled and Color3.fromRGB(0, 200, 100) or Color3.fromRGB(200, 0, 0)
        self.GUI.toggleBtn.Text = self.Settings.Enabled and "âœ… AKTÄ°F" or "âŒ DEVRE DIÅžI"
    end)
    
    self.GUI.modeBtn.MouseButton1Click:Connect(function()
        local modes = {"SAFE", "NORMAL", "AGGRESSIVE", "INSTANT", "GODLIKE"}
        local currentIndex = 0
        for i, mode in ipairs(modes) do
            if mode == self.Settings.ParryMode then
                currentIndex = i
                break
            end
        end
        local nextIndex = currentIndex % #modes + 1
        self.Settings.ParryMode = modes[nextIndex]
        self.GUI.modeBtn.Text = "MOD: " .. self.Settings.ParryMode
    end)
    
    -- Ana dÃ¶ngÃ¼ler
    local lastOptimize = tick()
    
    self.RunService.Heartbeat:Connect(function()
        if not self.Settings.Enabled then return end
        
        local threats = self:findThreats()
        
        for _, threat in ipairs(threats) do
            if self:shouldParry(threat) then
                self:parry(threat.ball)
                break
            end
        end
        
        -- Otomatik Ã¶zellikler
        if self.Settings.Features.AutoFarm then self:autoFarm() end
        if self.Settings.Features.AutoTarget then self:autoTarget() end
        if self.Settings.Features.AutoAbility then self:autoUseAbility() end
        if self.Settings.AI.Enabled then self:learn() end
        
        -- Performans optimizasyonu (saniyede bir)
        if tick() - lastOptimize > 1 then
            self:optimize()
            lastOptimize = tick()
        end
    end)
    
    self.RunService.RenderStepped:Connect(function()
        self:updateVisuals()
        
        -- Ä°statistikleri gÃ¼ncelle
        if self.GUI and self.GUI.stats then
            local avgTime = 0
            if #self.LearningData > 0 then
                for _, d in ipairs(self.LearningData) do
                    avgTime = avgTime + d.time
                end
                avgTime = avgTime / #self.LearningData
            end
            
            self.GUI.stats.Text = string.format(
                "âš¡ 31 AKTÄ°F âš¡\nðŸ”¥ Parry: %d | Kazanma: %%%.1f\nðŸŽ¯ Tepki: %dms | AI: %s",
                self.ParryCount,
                self.WinRate * 100,
                math.floor(avgTime * 1000),
                self.Settings.AI.Enabled and "Aktif" or "Pasif"
            )
        end
    end)
    
    -- F tuÅŸu ile aÃ§/kapa
    self.UserInputService.InputBegan:Connect(function(input, gpe)
        if not gpe and input.KeyCode == self.Settings.Keybind then
            self.Settings.Enabled = not self.Settings.Enabled
            print("âš¡ Blade Ball V6:", self.Settings.Enabled and "AKTÄ°F" or "DEVRE DIÅžI")
        end
    end)
    
    -- Karakter yeniden doÄŸunca
    self.LocalPlayer.CharacterAdded:Connect(function()
        task.wait(0.5)
        print("ðŸ”„ Karakter yenilendi, script hazÄ±r")
    end)
    
    -- BaÅŸlangÄ±Ã§ bildirimi
    local notification = Instance.new("TextLabel")
    notification.Size = UDim2.new(0, 450, 0, 120)
    notification.Position = UDim2.new(0.5, -225, 0.8, 0)
    notification.BackgroundColor3 = Color3.fromRGB(0, 50, 150)
    notification.BackgroundTransparency = 0.1
    notification.Text = "âš¡ 31 AKTÄ°F âš¡\nULTIMATE BLADE BALL V6\n6 KÃœTÃœPHANE ENTEGRE"
    notification.TextColor3 = Color3.new(1, 1, 1)
    notification.Font = Enum.Font.GothamBold
    notification.TextSize = 22
    notification.TextWrapped = true
    notification.Parent = self.CoreGui
    
    local notifCorner = Instance.new("UICorner")
    notifCorner.CornerRadius = UDim.new(0, 20)
    notifCorner.Parent = notification
    
    task.delay(5, function()
        notification:Destroy()
    end)
    
    print("âœ… ULTIMATE BLADE BALL V6 HAZIR!")
    print("ðŸŽ¯ F tuÅŸu ile aÃ§/kapa | Mod:", self.Settings.ParryMode)
    print("ðŸ“Š 6 kÃ¼tÃ¼phane aktif - En hÄ±zlÄ± algÄ±lama!")
end

-- ===== SCRÄ°PTÄ° BAÅžLAT =====
local bladeBall = UltimateBladeBallV6.new()
bladeBall:start()
